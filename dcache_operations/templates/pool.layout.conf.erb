######################################################################
##
## DO NOT EDIT
## generated by puppet module :  <%= @name %>
## node                       :  <%= @fqdn %>
##
######################################################################

<% if !@layout_hash.nil? -%>
<% if !@layout_hash['globals'].nil? -%>
<% @layout_hash['globals'].sort.each do |g_name,g_value| -%>
<%= g_name %>=<%= g_value %>
<% end -%>
<% end -%>
<% end -%>

<% @pool_layout_hash.sort.each do |pool_name,pool_info| -%>
[dcache-<%= pool_name %>Domain]
[dcache-<%= pool_name %>Domain/pool]
pool.name=dcache-<%= pool_name %>
pool.path=<%= pool_info['MOUNTPOINT'] %>
pool.wait-for-files=${pool.path}/data
<% if !@nfs_port.nil? -%>
pool.mover.nfs.port.min=<%= @nfs_port %>
pool.mover.nfs.port.max=<%= @nfs_port %>
<% @nfs_port = @nfs_port.to_i -%>
<% @nfs_port += 1 -%>
<% end -%>
<% if @hsm_pools.nil? and @rot_pools.nil? -%>
pool.lfs = precious
<% end -%>
<% if !@hsm_pools.nil? and @rot_pools.nil? -%>
<% if !@hsm_pools.include?(pool_name) -%>
pool.lfs = precious
<% end -%>
<% end -%>
<% if @hsm_pools.nil? and !@rot_pools.nil? -%>
<% if @rot_pools.include?(pool_name) -%>
pool.lfs = precious
<% end -%>
<% if @rot_pools.include?(pool_name) -%>
pool.lfs = volatile
pool.mover.nfs.thread-policy = WORKER_THREAD
<% end -%>
<% end -%>
<% if !@hsm_pools.nil? and !@rot_pools.nil? -%>
<% if !@hsm_pools.include?(pool_name) and @rot_pools.include?(pool_name) -%>
pool.lfs = volatile
pool.mover.nfs.thread-policy = WORKER_THREAD
<% end -%>
<% if !@hsm_pools.include?(pool_name) and !@rot_pools.include?(pool_name) -%>
pool.lfs = precious
<% end -%>
<% end -%>
<% if @partner == 'NONE'-%>
pool.tags=hostname=<%= @hostname -%>
<% else %>
<% host_number = @hostname.delete('^0-9').to_i -%>
<% host_partner = @partner.delete('^0-9').to_i -%>
<% if host_number < host_partner -%>
pool.tags=hostname=norepl-<%= host_number %>-<%= host_partner -%>
<% end -%>
<% if host_number > host_partner -%>
pool.tags=hostname=norepl-<%= host_partner %>-<%= host_number -%>

<% end -%>

<% end -%>
<% end %>
